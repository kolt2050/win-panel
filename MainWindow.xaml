<Window x:Class="WinPanel.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WinPanel"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ResizeMode="NoResize"
        SizeToContent="WidthAndHeight"
        ShowInTaskbar="False"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        Loaded="Window_Loaded">
    
    <Grid>
        <!-- Main Border with Glass-like appearance -->
        <!-- Added Margin to allow space for DropShadow and proper anti-aliasing -->
        <Border x:Name="MainBorder" CornerRadius="12" Padding="0" Margin="20"
                MinWidth="60" MinHeight="60"
                BorderBrush="#40FFFFFF" BorderThickness="1"
                MouseRightButtonUp="Panel_RightClick"
                AllowDrop="True"
                DragEnter="Window_DragEnter"
                DragOver="Window_DragOver"
                Drop="Window_Drop"
                DragLeave="Window_DragLeave">
            
            <Border.Background>
                <SolidColorBrush Color="#CC1E1E2E"/>
            </Border.Background>
            
            <Border.LayoutTransform>
                <ScaleTransform x:Name="PanelScale" ScaleX="1" ScaleY="1"/>
            </Border.LayoutTransform>
            
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="0" Opacity="0.5" Color="Black"/>
            </Border.Effect>
            
            <Grid>
                <!-- Shortcuts Panel -->
                <ItemsControl x:Name="ShortcutsPanel" Margin="3,4">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel x:Name="ShortcutsStack" Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Click="Shortcut_Click"
                                    MouseRightButtonUp="Shortcut_RightClick"
                                    PreviewMouseLeftButtonDown="Shortcut_PreviewMouseLeftButtonDown"
                                    PreviewMouseMove="Shortcut_PreviewMouseMove"
                                    Tag="{Binding}">
                                <Button.Style>
                                    <Style TargetType="Button" BasedOn="{StaticResource ShortcutButtonStyle}">
                                        <Style.Triggers>
                                            <!-- Placeholder trigger removed -->
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                                <Image Source="{Binding Icon}" Width="32" Height="32" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <!-- Resize Grip (inside Border to scale with it) -->
                <Thumb x:Name="ResizeGrip" 
                       Width="16" Height="16"
                       HorizontalAlignment="Right" 
                       VerticalAlignment="Bottom"
                       Margin="0,0,2,2"
                       Cursor="SizeNWSE"
                       DragDelta="ResizeGrip_DragDelta"
                       Opacity="0.5">
                    <Thumb.Template>
                        <ControlTemplate TargetType="Thumb">
                            <Grid Background="Transparent">
                                <Path Data="M 0,12 L 12,0 M 4,12 L 12,4 M 8,12 L 12,8" 
                                      Stroke="#888888" StrokeThickness="1.5"/>
                            </Grid>
                        </ControlTemplate>
                    </Thumb.Template>
                </Thumb>
            </Grid>
        </Border>
    </Grid>
    
    <!-- Context Menu for Shortcuts -->
    <Window.Resources>
        <ContextMenu x:Key="ShortcutContextMenu">
            <MenuItem Header="ðŸš€ Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ" Click="ContextMenu_Launch"/>
            <MenuItem Header="ðŸ“‚ ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ñ€Ð°ÑÐ¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ" Click="ContextMenu_OpenLocation"/>
            <Separator/>
            <MenuItem Header="âŒ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" Click="ContextMenu_Delete"/>
        </ContextMenu>
        
        <!-- Panel Context Menu -->
        <ContextMenu x:Key="PanelContextMenu" Opened="PanelContextMenu_Opened">
            <MenuItem Header="ï¿½ ÐŸÐ¾Ð»Ð½Ð¾Ðµ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ" Click="MenuUninstall_Click" Foreground="#FF5555"/>
            <Separator/>
            <MenuItem Header="ðŸš€ ÐÐ²Ñ‚Ð¾Ð·Ð°Ð¿ÑƒÑÐº" x:Name="MenuAutostart" IsCheckable="True" Click="MenuAutostart_Click"/>
            <Separator/>
            <MenuItem Header="ï¿½ðŸ“ ÐžÑ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ">
                <MenuItem x:Name="MenuHorizontal" Header="â†” Ð“Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð¾" Click="Layout_Horizontal" IsCheckable="True" IsChecked="True"/>
                <MenuItem x:Name="MenuVertical" Header="â†• Ð’ÐµÑ€Ñ‚Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾" Click="Layout_Vertical" IsCheckable="True"/>
            </MenuItem>
            <MenuItem Header="ðŸ” Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±" Click="ResetScale_Click"/>
            <MenuItem Header="ðŸ‘ ÐŸÑ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½Ð¾ÑÑ‚ÑŒ">
                <StackPanel Orientation="Horizontal" Margin="4">
                    <Slider Width="150" Minimum="20" Maximum="100" 
                            Value="{Binding PanelOpacity, Mode=TwoWay}"/>
                    <TextBlock Text="{Binding PanelOpacity, StringFormat='{}{0:0}%'}" Foreground="#888888" 
                               FontSize="11" VerticalAlignment="Center" Margin="8,0,0,0"/>
                </StackPanel>
            </MenuItem>
            <Separator/>
            <MenuItem Header="âŒ Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ" Click="Menu_Close"/>
        </ContextMenu>
    </Window.Resources>
</Window>
